{"ast":null,"code":"import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\nimport axios from \"axios\";\nimport { NotificationManager } from 'react-notifications';\nimport { LOGIN_USER, REGISTER_USER, LOGOUT_USER } from '../actions';\nimport { loginUserSuccess, loginUserError, registerUserSuccess, registerUserError } from './actions';\nimport { setCurrentUser } from '../../helpers/Utils';\nimport { API_URL } from \"../../apiUrl.js\";\nexport function* watchLoginUser() {\n  yield takeEvery(LOGIN_USER, loginWithEmailPassword);\n}\n\nconst loginWithEmailPasswordAsync = async (email, password, history) => await axios.post(`${API_URL}/user/login`, {\n  email,\n  password\n}).then(user => {\n  /* console.log(\"user\", user) */\n  if (user.status === 200) {\n    setCurrentUser(user.data.data);\n    put(loginUserSuccess(user.data.data));\n    NotificationManager.success(user.data.message);\n\n    if (user.data.data.role === \"seller\") {\n      history.push(\"/seller\");\n    } else if (user.data.data.role === \"buyer\") {\n      history.push(\"/buyer\");\n    }\n  } else if (user.status === 206) {\n    put(loginUserError(user.data.message));\n    NotificationManager.warning(user.data.message);\n  }\n}).catch(error => NotificationManager.warning(error));\n\nfunction* loginWithEmailPassword({\n  payload\n}) {\n  const {\n    email,\n    password\n  } = payload.user;\n  const {\n    history\n  } = payload;\n  yield call(loginWithEmailPasswordAsync, email, password, history);\n}\n\nexport function* watchRegisterUser() {\n  yield takeEvery(REGISTER_USER, registerWithEmailPassword);\n}\n\nconst registerWithEmailPasswordAsync = async (username, email, password, role, history) => await axios.post(`${API_URL}/user/register`, {\n  username,\n  email,\n  password,\n  role\n}).then(user => {\n  if (user.status === 200) {\n    put(registerUserSuccess(user.data.data));\n    NotificationManager.success(user.data.message);\n    history.push('/login');\n  } else if (user.status === 206) {\n    put(registerUserError(user.data.message));\n    NotificationManager.warning(user.data.message);\n  }\n}).catch(error => {\n  NotificationManager.warning(error, 'Registeration Error', 3000, null, null, '');\n});\n\nfunction* registerWithEmailPassword({\n  payload\n}) {\n  console.log(\"value register\", payload);\n  const {\n    username,\n    email,\n    password,\n    role\n  } = payload.user;\n  const {\n    history\n  } = payload;\n\n  try {\n    yield call(registerWithEmailPasswordAsync, username, email, password, role, history);\n    /* console.log(\"register user data\", registerUser) */\n  } catch (error) {\n    yield put(registerUserError(error));\n  }\n}\n\nexport function* watchLogoutUser() {\n  yield takeEvery(LOGOUT_USER, logout);\n}\n\nfunction* logout({\n  payload\n}) {\n  const {\n    history\n  } = payload;\n  setCurrentUser();\n  history.push(\"/\");\n}\n\nexport default function* rootSaga() {\n  yield all([fork(watchLoginUser), fork(watchLogoutUser), fork(watchRegisterUser)]);\n}","map":{"version":3,"sources":["/Users/zibranshaikh/Downloads/scaffoldzoid/frontend/src/redux/auth/saga.js"],"names":["all","call","fork","put","takeEvery","axios","NotificationManager","LOGIN_USER","REGISTER_USER","LOGOUT_USER","loginUserSuccess","loginUserError","registerUserSuccess","registerUserError","setCurrentUser","API_URL","watchLoginUser","loginWithEmailPassword","loginWithEmailPasswordAsync","email","password","history","post","then","user","status","data","success","message","role","push","warning","catch","error","payload","watchRegisterUser","registerWithEmailPassword","registerWithEmailPasswordAsync","username","console","log","watchLogoutUser","logout","rootSaga"],"mappings":"AAAA,SAASA,GAAT,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,GAA1B,EAA+BC,SAA/B,QAAgD,oBAAhD;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,SAASC,mBAAT,QAAoC,qBAApC;AAGA,SACEC,UADF,EAEEC,aAFF,EAGEC,WAHF,QAKO,YALP;AAOA,SACEC,gBADF,EAEEC,cAFF,EAGEC,mBAHF,EAIEC,iBAJF,QAMO,WANP;AAOA,SAASC,cAAT,QAA+B,qBAA/B;AACA,SAASC,OAAT,QAAwB,iBAAxB;AAGA,OAAO,UAAUC,cAAV,GAA2B;AAChC,QAAMZ,SAAS,CAACG,UAAD,EAAaU,sBAAb,CAAf;AACD;;AAED,MAAMC,2BAA2B,GAAG,OAAOC,KAAP,EAAcC,QAAd,EAAwBC,OAAxB,KAElC,MAAMhB,KAAK,CAACiB,IAAN,CAAY,GAAEP,OAAQ,aAAtB,EAAoC;AAAEI,EAAAA,KAAF;AAASC,EAAAA;AAAT,CAApC,EACHG,IADG,CACGC,IAAD,IAAU;AACd;AACA,MAAIA,IAAI,CAACC,MAAL,KAAgB,GAApB,EAAyB;AACvBX,IAAAA,cAAc,CAACU,IAAI,CAACE,IAAL,CAAUA,IAAX,CAAd;AACAvB,IAAAA,GAAG,CAACO,gBAAgB,CAACc,IAAI,CAACE,IAAL,CAAUA,IAAX,CAAjB,CAAH;AAEApB,IAAAA,mBAAmB,CAACqB,OAApB,CAA4BH,IAAI,CAACE,IAAL,CAAUE,OAAtC;;AACA,QAAIJ,IAAI,CAACE,IAAL,CAAUA,IAAV,CAAeG,IAAf,KAAwB,QAA5B,EAAsC;AACpCR,MAAAA,OAAO,CAACS,IAAR,CAAa,SAAb;AACD,KAFD,MAEO,IAAIN,IAAI,CAACE,IAAL,CAAUA,IAAV,CAAeG,IAAf,KAAwB,OAA5B,EAAqC;AAC1CR,MAAAA,OAAO,CAACS,IAAR,CAAa,QAAb;AACD;AAEF,GAXD,MAWO,IAAIN,IAAI,CAACC,MAAL,KAAgB,GAApB,EAAyB;AAC9BtB,IAAAA,GAAG,CAACQ,cAAc,CAACa,IAAI,CAACE,IAAL,CAAUE,OAAX,CAAf,CAAH;AACAtB,IAAAA,mBAAmB,CAACyB,OAApB,CAA4BP,IAAI,CAACE,IAAL,CAAUE,OAAtC;AACD;AACF,CAlBG,EAmBHI,KAnBG,CAmBIC,KAAD,IAAW3B,mBAAmB,CAACyB,OAApB,CAA4BE,KAA5B,CAnBd,CAFR;;AAuBA,UAAUhB,sBAAV,CAAiC;AAAEiB,EAAAA;AAAF,CAAjC,EAA8C;AAC5C,QAAM;AAAEf,IAAAA,KAAF;AAASC,IAAAA;AAAT,MAAsBc,OAAO,CAACV,IAApC;AACA,QAAM;AAAEH,IAAAA;AAAF,MAAca,OAApB;AAEC,QAAMjC,IAAI,CAACiB,2BAAD,EAA8BC,KAA9B,EAAqCC,QAArC,EAA+CC,OAA/C,CAAV;AACF;;AAED,OAAO,UAAUc,iBAAV,GAA8B;AAEnC,QAAM/B,SAAS,CAACI,aAAD,EAAgB4B,yBAAhB,CAAf;AACD;;AAED,MAAMC,8BAA8B,GAAG,OAAOC,QAAP,EAAiBnB,KAAjB,EAAwBC,QAAxB,EAAkCS,IAAlC,EAAwCR,OAAxC,KAEvC,MAAMhB,KAAK,CAACiB,IAAN,CAAY,GAAEP,OAAQ,gBAAtB,EAAuC;AAAEuB,EAAAA,QAAF;AAAYnB,EAAAA,KAAZ;AAAmBC,EAAAA,QAAnB;AAA6BS,EAAAA;AAA7B,CAAvC,EAEDN,IAFC,CAEKC,IAAD,IAAU;AAEd,MAAIA,IAAI,CAACC,MAAL,KAAgB,GAApB,EAAyB;AACvBtB,IAAAA,GAAG,CAACS,mBAAmB,CAACY,IAAI,CAACE,IAAL,CAAUA,IAAX,CAApB,CAAH;AACApB,IAAAA,mBAAmB,CAACqB,OAApB,CAA4BH,IAAI,CAACE,IAAL,CAAUE,OAAtC;AACAP,IAAAA,OAAO,CAACS,IAAR,CAAa,QAAb;AACD,GAJD,MAIO,IAAIN,IAAI,CAACC,MAAL,KAAgB,GAApB,EAAyB;AAC9BtB,IAAAA,GAAG,CAACU,iBAAiB,CAACW,IAAI,CAACE,IAAL,CAAUE,OAAX,CAAlB,CAAH;AACAtB,IAAAA,mBAAmB,CAACyB,OAApB,CAA4BP,IAAI,CAACE,IAAL,CAAUE,OAAtC;AACD;AAEF,CAbC,EAcDI,KAdC,CAcMC,KAAD,IAAW;AAEhB3B,EAAAA,mBAAmB,CAACyB,OAApB,CAA4BE,KAA5B,EAAmC,qBAAnC,EAA0D,IAA1D,EAAgE,IAAhE,EAAsE,IAAtE,EAA4E,EAA5E;AACD,CAjBC,CAFN;;AAqBA,UAAUG,yBAAV,CAAoC;AAAEF,EAAAA;AAAF,CAApC,EAAiD;AAC/CK,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BN,OAA9B;AACA,QAAM;AAAEI,IAAAA,QAAF;AAAYnB,IAAAA,KAAZ;AAAmBC,IAAAA,QAAnB;AAA6BS,IAAAA;AAA7B,MAAsCK,OAAO,CAACV,IAApD;AACA,QAAM;AAAEH,IAAAA;AAAF,MAAca,OAApB;;AACA,MAAI;AACF,UAAMjC,IAAI,CACRoC,8BADQ,EAERC,QAFQ,EAEEnB,KAFF,EAESC,QAFT,EAEmBS,IAFnB,EAEyBR,OAFzB,CAAV;AAKA;AAED,GARD,CAQE,OAAOY,KAAP,EAAc;AACd,UAAM9B,GAAG,CAACU,iBAAiB,CAACoB,KAAD,CAAlB,CAAT;AACD;AACF;;AAED,OAAO,UAAUQ,eAAV,GAA4B;AAEjC,QAAMrC,SAAS,CAACK,WAAD,EAAciC,MAAd,CAAf;AACD;;AAID,UAAUA,MAAV,CAAiB;AAAER,EAAAA;AAAF,CAAjB,EAA8B;AAC5B,QAAM;AAAEb,IAAAA;AAAF,MAAca,OAApB;AACApB,EAAAA,cAAc;AACdO,EAAAA,OAAO,CAACS,IAAR,CAAa,GAAb;AAED;;AAKD,eAAe,UAAUa,QAAV,GAAqB;AAClC,QAAM3C,GAAG,CAAC,CACRE,IAAI,CAACc,cAAD,CADI,EAERd,IAAI,CAACuC,eAAD,CAFI,EAGRvC,IAAI,CAACiC,iBAAD,CAHI,CAAD,CAAT;AAMD","sourcesContent":["import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\nimport axios from \"axios\"\nimport { NotificationManager } from 'react-notifications';\n\n\nimport {\n  LOGIN_USER,\n  REGISTER_USER,\n  LOGOUT_USER,\n\n} from '../actions';\n\nimport {\n  loginUserSuccess,\n  loginUserError,\n  registerUserSuccess,\n  registerUserError,\n\n} from './actions';\nimport { setCurrentUser } from '../../helpers/Utils';\nimport { API_URL } from \"../../apiUrl.js\"\n\n\nexport function* watchLoginUser() {\n  yield takeEvery(LOGIN_USER, loginWithEmailPassword);\n}\n\nconst loginWithEmailPasswordAsync = async (email, password, history) =>\n\n  await axios.post(`${API_URL}/user/login`, { email, password })\n    .then((user) => {\n      /* console.log(\"user\", user) */\n      if (user.status === 200) {\n        setCurrentUser(user.data.data);\n        put(loginUserSuccess(user.data.data));\n\n        NotificationManager.success(user.data.message);\n        if (user.data.data.role === \"seller\") {\n          history.push(\"/seller\")\n        } else if (user.data.data.role === \"buyer\") {\n          history.push(\"/buyer\")\n        }\n\n      } else if (user.status === 206) {\n        put(loginUserError(user.data.message))\n        NotificationManager.warning(user.data.message);\n      }\n    })\n    .catch((error) => NotificationManager.warning(error));\n\nfunction* loginWithEmailPassword({ payload }) {\n  const { email, password } = payload.user;\n  const { history } = payload;\n  \n   yield call(loginWithEmailPasswordAsync, email, password, history);\n}\n\nexport function* watchRegisterUser() {\n  \n  yield takeEvery(REGISTER_USER, registerWithEmailPassword);\n}\n\nconst registerWithEmailPasswordAsync = async (username, email, password, role, history) =>\n\nawait axios.post(`${API_URL}/user/register`, { username, email, password, role })\n    \n    .then((user) => {\n    \n      if (user.status === 200) {\n        put(registerUserSuccess(user.data.data))\n        NotificationManager.success(user.data.message);\n        history.push('/login')\n      } else if (user.status === 206) {\n        put(registerUserError(user.data.message))\n        NotificationManager.warning(user.data.message);\n      }\n\n    })\n    .catch((error) => {\n     \n      NotificationManager.warning(error, 'Registeration Error', 3000, null, null, '')\n    });\n\nfunction* registerWithEmailPassword({ payload }) {\n  console.log(\"value register\", payload)\n  const { username, email, password, role } = payload.user;\n  const { history } = payload;\n  try {\n    yield call(\n      registerWithEmailPasswordAsync,\n      username, email, password, role, history\n\n    );\n    /* console.log(\"register user data\", registerUser) */\n\n  } catch (error) {\n    yield put(registerUserError(error));\n  }\n}\n\nexport function* watchLogoutUser() {\n\n  yield takeEvery(LOGOUT_USER, logout);\n}\n\n\n\nfunction* logout({ payload }) {\n  const { history } = payload;\n  setCurrentUser();\n  history.push(\"/\");\n\n}\n\n\n\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchLoginUser),\n    fork(watchLogoutUser),\n    fork(watchRegisterUser),\n\n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}