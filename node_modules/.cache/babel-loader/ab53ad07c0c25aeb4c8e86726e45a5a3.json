{"ast":null,"code":"import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\nimport axios from \"axios\";\nimport { NotificationManager } from 'react-notifications';\nimport { LOGIN_USER, REGISTER_USER, LOGOUT_USER } from '../actions';\nimport { loginUserSuccess, loginUserError, registerUserSuccess, registerUserError } from './actions';\n/* import { adminRoot, currentUser } from '../../constants/defaultValues'; */\n\nimport { setCurrentUser } from '../../helpers/Utils';\nimport { API_URL } from \"../../apiUrl.js\";\nexport function* watchLoginUser() {\n  // eslint-disable-next-line no-use-before-define\n  yield takeEvery(LOGIN_USER, loginWithEmailPassword);\n}\n\nconst loginWithEmailPasswordAsync = async (email, password, history) => // eslint-disable-next-line no-return-await\nawait axios.post(`${API_URL}/login`, {\n  email,\n  password\n})\n/*  .signInWithEmailAndPassword(email, password) */\n.then(user => {\n  console.log(\"user\", user);\n\n  if (user.status === 200) {\n    setCurrentUser(user.data.data);\n    put(loginUserSuccess(user.data.msg));\n    NotificationManager.success(user.data.msg, 'Sucessfully Logged In', 3000, null, null, '');\n    /* history.push(adminRoot) */\n  } else if (user.status === 206) {\n    put(loginUserError(user.data.msg));\n    NotificationManager.warning(user.data.msg, 'Login User', 3000, null, null, '');\n  }\n}).catch(error => NotificationManager.warning(error, 'Login Error', 3000, null, null, ''));\n\nfunction* loginWithEmailPassword({\n  payload\n}) {\n  const {\n    email,\n    password\n  } = payload.user;\n  const {\n    history\n  } = payload;\n  /*  try { */\n\n  const loginUser = yield call(loginWithEmailPasswordAsync, email, password, history);\n  /*  if (!loginUser.message) {\n     const item = { uid: loginUser.user.uid, ...currentUser };\n     setCurrentUser(item);\n     yield put(loginUserSuccess(item));\n     history.push(adminRoot);\n   } else {\n     yield put(loginUserError(loginUser.message));\n   }\n  } catch (error) {\n   yield put(loginUserError(error));\n  } */\n}\n\nexport function* watchRegisterUser() {\n  // eslint-disable-next-line no-use-before-define\n  yield takeEvery(REGISTER_USER, registerWithEmailPassword);\n}\n\nconst registerWithEmailPasswordAsync = async (username, email, password, role) => // eslint-disable-next-line no-return-await\nawait axios.post(`${API_URL}/user/register`, {\n  username,\n  email,\n  password,\n  role\n})\n/* .createUserWithEmailAndPassword(name,mobile, email, password) */\n.then(user => {\n  /*  console.log(\"user\", user) */\n  if (user.status === 200) {\n    put(registerUserSuccess(user.data));\n    NotificationManager.success(user.data.message\n    /* , 'Registeration Succesfull', 3000, null, null, '' */\n    );\n  } else if (user.status === 206) {\n    put(registerUserError(user.data.msg));\n    NotificationManager.warning(user.data.message\n    /* , 'Registered User', 3000, null, null, '' */\n    );\n  }\n}).catch(error => {\n  /*  console.log(error, \"err\") */\n  NotificationManager.warning(error, 'Registeration Error', 3000, null, null, '');\n});\n\nfunction* registerWithEmailPassword({\n  payload\n}) {\n  console.log(\"value register\", payload);\n  const {\n    username,\n    email,\n    password,\n    role\n  } = payload.user;\n  const {\n    history\n  } = payload;\n\n  try {\n    const registerUser = yield call(registerWithEmailPasswordAsync, username, email, password, role);\n    console.log(\"register user data\", registerUser);\n    /*  if (!registerUser.message) {\n       const item = { uid: registerUser.user.id,};\n      \n        setCurrentUser(item);\n       yield put(registerUserSuccess(item));\n       history.push(adminRoot);\n     } else {\n       yield put(registerUserError(registerUser.message));\n     } */\n  } catch (error) {\n    yield put(registerUserError(error));\n  }\n}\n/* export function* watchLogoutUser() {\n  \n  yield takeEvery(LOGOUT_USER, logout);\n}\n\nconst logoutAsync = async (history) => {\n  await auth\n    .signOut()\n    .then((user) => user)\n    .catch((error) => error);\n  history.push(\"/\");\n};\n\nfunction* logout({ payload }) {\n  const { history } = payload;\n  setCurrentUser();\n  yield call(logoutAsync, history);\n}\n */\n\n\nexport default function* rootSaga() {\n  yield all([fork(watchLoginUser),\n  /* fork(watchLogoutUser), */\n  fork(watchRegisterUser)]);\n}","map":{"version":3,"sources":["/Users/zibranshaikh/Downloads/scaffoldzoid/frontend/src/redux/auth/saga.js"],"names":["all","call","fork","put","takeEvery","axios","NotificationManager","LOGIN_USER","REGISTER_USER","LOGOUT_USER","loginUserSuccess","loginUserError","registerUserSuccess","registerUserError","setCurrentUser","API_URL","watchLoginUser","loginWithEmailPassword","loginWithEmailPasswordAsync","email","password","history","post","then","user","console","log","status","data","msg","success","warning","catch","error","payload","loginUser","watchRegisterUser","registerWithEmailPassword","registerWithEmailPasswordAsync","username","role","message","registerUser","rootSaga"],"mappings":"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","sourcesContent":["import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\nimport axios from \"axios\"\nimport { NotificationManager } from 'react-notifications';\n\n\nimport {\n  LOGIN_USER,\n  REGISTER_USER,\n  LOGOUT_USER,\n  \n} from '../actions';\n\nimport {\n  loginUserSuccess,\n  loginUserError,\n  registerUserSuccess,\n  registerUserError,\n \n} from './actions';\n\n/* import { adminRoot, currentUser } from '../../constants/defaultValues'; */\nimport {  setCurrentUser } from '../../helpers/Utils';\nimport {API_URL} from \"../../apiUrl.js\"\n\n\nexport function* watchLoginUser() {\n  // eslint-disable-next-line no-use-before-define\n  yield takeEvery(LOGIN_USER, loginWithEmailPassword);\n}\n\nconst loginWithEmailPasswordAsync = async (email, password, history) =>\n  // eslint-disable-next-line no-return-await\n  await axios.post(`${API_URL}/login`, { email, password })\n    /*  .signInWithEmailAndPassword(email, password) */\n    .then((user) => {\n      console.log(\"user\", user)\n      if (user.status === 200) {\n        setCurrentUser(user.data.data);\n        put(loginUserSuccess(user.data.msg));\n        NotificationManager.success(user.data.msg, 'Sucessfully Logged In', 3000, null, null, '');\n        /* history.push(adminRoot) */\n      } else if (user.status === 206) {\n        put(loginUserError(user.data.msg))\n        NotificationManager.warning(user.data.msg, 'Login User', 3000, null, null, '');\n      }\n    })\n    .catch((error) => NotificationManager.warning(error, 'Login Error', 3000, null, null, ''));\n\nfunction* loginWithEmailPassword({ payload }) {\n  const { email, password } = payload.user;\n  const { history } = payload;\n  /*  try { */\n  const loginUser = yield call(loginWithEmailPasswordAsync, email, password, history);\n  \n  /*  if (!loginUser.message) {\n     const item = { uid: loginUser.user.uid, ...currentUser };\n     setCurrentUser(item);\n     yield put(loginUserSuccess(item));\n     history.push(adminRoot);\n   } else {\n     yield put(loginUserError(loginUser.message));\n   }\n } catch (error) {\n   yield put(loginUserError(error));\n } */\n}\n\nexport function* watchRegisterUser() {\n  // eslint-disable-next-line no-use-before-define\n  yield takeEvery(REGISTER_USER, registerWithEmailPassword);\n}\n\nconst registerWithEmailPasswordAsync = async (username,email, password, role) =>\n\n  // eslint-disable-next-line no-return-await\n  await axios.post(`${API_URL}/user/register`, { username,email, password, role })\n    /* .createUserWithEmailAndPassword(name,mobile, email, password) */\n    .then((user) => {\n      /*  console.log(\"user\", user) */\n      if (user.status === 200) {\n        put(registerUserSuccess(user.data))\n        NotificationManager.success(user.data.message/* , 'Registeration Succesfull', 3000, null, null, '' */);\n      } else if (user.status === 206) {\n        put(registerUserError(user.data.msg))\n        NotificationManager.warning(user.data.message/* , 'Registered User', 3000, null, null, '' */);\n      }\n\n    })\n    .catch((error) => {\n      /*  console.log(error, \"err\") */\n      NotificationManager.warning(error, 'Registeration Error', 3000, null, null, '')\n    });\n\nfunction* registerWithEmailPassword({ payload }) {\n  console.log(\"value register\", payload)\n  const { username,email, password ,role} = payload.user;\n  const { history } = payload;\n  try {\n    const registerUser = yield call(\n      registerWithEmailPasswordAsync,\n      username,email, password, role\n      \n    );\n    console.log(\"register user data\", registerUser)\n    /*  if (!registerUser.message) {\n       const item = { uid: registerUser.user.id,};\n      \n        setCurrentUser(item);\n       yield put(registerUserSuccess(item));\n       history.push(adminRoot);\n     } else {\n       yield put(registerUserError(registerUser.message));\n     } */\n  } catch (error) {\n    yield put(registerUserError(error));\n  }\n}\n\n/* export function* watchLogoutUser() {\n  \n  yield takeEvery(LOGOUT_USER, logout);\n}\n\nconst logoutAsync = async (history) => {\n  await auth\n    .signOut()\n    .then((user) => user)\n    .catch((error) => error);\n  history.push(\"/\");\n};\n\nfunction* logout({ payload }) {\n  const { history } = payload;\n  setCurrentUser();\n  yield call(logoutAsync, history);\n}\n */\n\n\n\nexport default function* rootSaga() {\n  yield all([\n    fork(watchLoginUser),\n    /* fork(watchLogoutUser), */\n    fork(watchRegisterUser),\n   \n  ]);\n}\n"]},"metadata":{},"sourceType":"module"}